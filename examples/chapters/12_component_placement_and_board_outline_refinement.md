# Component Placement and Board Outline Refinement



25 mm because it's very difficult to draw straight lines on very small grid I'm using my side to side cursors here to help me with the drawing actually before I start drawing I just want to remind you what I'm trying to do so I'm going to make sure that there is no PCB below the antenna and that there is a minimum of 50 15 mm on the left side of the antenna start drawing here straight line up to this point then I'm going to click right here and to make sure that I've got 15 mm clearance I'm going to hit this space

bar on my keyboard to zero the numbers down the bottom you can see DX and Dy and from here I'm going to go for another 15 mm you can can see that the cursor also tells me how far from the previous click I've gone so that's now 15 mm I'll give it a little more let's make it 16 that's it and then I'm going to go up and then continue towards the left I'm going to go up to here because I've got a lot of empty space in this board so I'll be able to make the board a little smaller I'm not going to commit to anything though but I'm just going to

stop the drawing say at 90 mm and continue drawing down I want to make sure that I don't go too far down so I'll zoom out a bit make sure that I go up to the point that I started the drawing at the bottom right corner of the SD card so around here that's it and zoom in to close the line you can see that ker tells me that I've got a close line because it puts a circle around the point where the two lines meet now I've got a board I'm not going to spend any time here to refine it I like boards with circular edges

look modern and pretty you know attention the detail but I'm going to worry about rounding the corners later once I've committed with the placement of the components and and I know that that's where the components are going to be sitting permanently just going to make sure that everything fits by moving a few things around and just drag that to the left like that and I have to do the same with this line I'm going to bring this set of components inside as well do the same here make sure that everything is inside

and then I'm going to start with the refinement okay so that is the first pass of the component placement I have set the main components in the approximate locations where they're going to end up being anyway and then all of the other smaller components especially the resistors and the capacitors are nearby the components that they support but I'm going to be fine-tuning them later with their actual positions and I'm going to be doing that next so my objective is primarily to make sure that any signal conditioning

component and that is resistors and capacitors are in the appropriate locations for the main component that they support and only after I do that I'll be able to finalize the board layout and then I'll start with the rating so now that I've placed the components where they are most likely going to end up on the board and I've got the rough outline of the board I'm going to concentrate on the smaller components and specifically the capacitors and the resistors which play a significant role to what's called signal conditioning signal conditioning

involves the preparation of the output from the various components such as the BME 280 the sound sensor or even the esp32 microcontroller itself to ensure that these signals are suitable for usage by other components so for example signals coming out of the esp32 to the SD card radar need to be conditioned to make sure that the SD card radar is receiving actual correct signals this preparation might include things such as amplifying weak sensor signals for example coming out of the sound sensor to match the input range of

the esp32s ADC the analog digital converter or filtering out noise to improve signal Clarity and converting signals to compa voltage levels in our project most of the signal conditioning that we do has to do with filtering out noise but also we'll be doing amplification in the case of the analog sensors before I start manipulating any of the components on the board and just putting them in most likely their final positions on the board I just want to talk a little bit about the work that I'll be doing and why I'll be doing it

things that I'm about to briefly talk about and not things that you'll find in a component data sheet so I'm going to start with the capacitors first you can see there's plenty of them and here's a few examples here that relate to the esp32 these capacitors serve several key functions in single conditioning we've got decoupling capacitors which mitigate power supply Noise by providing a local source of current for integrated circuits and here's one example this particular capacitor here and its counterpart right here we are going to

place those as close as possible to the power pins of the integrated circuit to minimize Trace length and inductance smaller capacitor values such as 0.1 microfarads should be placed closer to the Power Pin than larger ones this Arrangement effectively handles high frequency noise and switching transients we also have bypass capacitors which offer a low impendence path to ground for ac6 signal and those filter noise and prevent interference with sensitive circuitry and we position those near the component that requires protection on

the signal path side ensuring clean signals so I'm going to talk more about those in a moment there's also bulk capacitors that act as charge reservoirs stabilizing the power supply by smoothing out voltage fluctuations and we locate those near the board power supply so you'll see a couple of book capacitors down here we've got the USB C connector and the battery connector there's also resistors we use pull up or pull down resistors to establish defined logic levels on Signal lines when they're not actively driven

and we place those near the input pin of the associated integrated circuit connected directly to the appropriate voltage Rail and we use such resistors in this circuit in the I qu C interface lines there's also filter resistors which work in conjunction with capacitors to form low pass or high pass filters and the precise placement is crucial for the filter's Effectiveness and requires careful consideration within the filter circuit design and of course you probably know about this there's also current limiting resistors

to protect components such as LEDs by restricting current flow in each one of the LEDs here have a current limiting resistor now I just want to be a little bit more specific about how I use those components especially the resistors and the capacitors in this circuit just want to show you a couple of examples let's go to the esp32 module and right here if I search for C8 you'll see there's a C8 capacitor right here this is this smaller device right here so this is a decoupling capacitor we're going to position this capacitor

very close close or as close as possible to the 3.3 Vol pin yes as close as I can and then later on we're going to draw a track that connects pin one of the capacitor to pin one of the esp32 module you can see how close it is right there in addition to the C8 capacitor there also the C7 just going to rotate that and place that as as close as possible to C8 and that's there to further reduce high frequency noise so the combination of these two capacitor values and the close proximity to the esp32s pin one which is where the

3.3 volt goes ensures effective decoupling across awide frequency range now let's have a look at another example here is u4 this is the USB to serial bridge and it also requires a decoupling capacitor so here in the schematic you can see C11 is a decoupling capacitor that is connected directly to the vbus pin and it's this capacitor here if I move it just to see where the rut nests go you can see it's going to zoom in here's vbus here is the vbus net as well I'm going to place that as close as I can this positions are subject to change

as well a little later because one of my other concerns is to minimize the length of of routes and to minimize wires Crossing each other so may need to rotate the main components as well like in this case the USB Bridge or u4 like this so depending on which final orientation the USB bridge and other chips have on the board I'm going to have to adjust the location of the smaller components but let's say this is the PIN 8 right here I'm just going to rotate this a little more so that it has this orientation so there is pin 8 vbus

and let's say that this would be the final position for u4 I would Place C11 like this so then it would be just small track to connect pin 8 of u4 to pin one of C11 so that's another example of how I would do placement here another example worth mentioning here are the input and output capacitors for the lipo charger so the lightboard charge um search for U1 so here's U1 you can see the schematic as well there's a couple of capacitors here or there is one capacitor to be more exact there is the input capacitor C6 which I've just

clicked on and it appears here as well and you can see that there is a + 5 Vol USB net which is supposed to connect to pin 18 right there you can see the r Nest as well so to make that easier to Route I'd rotate the main component like this and the capacitor like this and now you can see this there's multiple USB pads on U1 but I would take one of those and connect it as close as I can to the capacitor C6 like that that would minimize the length of the traces the next thing I want to show you are a couple of resistors these are the pullup

resistors for the SD card the SD card is right here clicking on that brings the schematic or Focus the schematic on the SD card and you can see there is an example of a pull-up resistor this is r19 and it's this one right here and it goes in between the cssd pin which is pin number one on the SD card module and the 3.

3 volt I would connect that play set like this very close to pin one of the SD card now another thing that is important to consider that has got to do with routing not with positioning of components has to do with routing for SBI signals in particular so the SBI signals that are connecting the esp32 to the flash memory and the SD card need to be routed using bus topology in such topology a single continuous Trace connects all devices so having said all that I'm going to now start moving things around and positioning the

especially the passive components to the Final locations around the main components and then once I do that and have all that fixed I will remove all m dis Space by tucking components closer to each other if you are curious about some more specifics about highspeed layout guidelines that cover things such as transmission lines and cross talk and return current and loop areas Etc have a look at this guidelines document from Texas Instruments that covers a lot of the topics I find very interesting these are things that you don't find in other

data sheets and you don't find in most books actually or tutorials find it having a quick look at this document at least will give you some Basics or some basic understanding broad guidelines on how to do all of the above that are mentioned especially for high speed designs much of what is in this document is a bit of an nooc kill for the board that I'm designing here but many other bits and pieces such as for example how to draw traces vs actually are very relevant so look for a link to this document in the description below the

video video let's begin with the refinement I'm going to start from the right of the board and work my way towards the left first with the esp32 I'm going to use this dual Window mode so that I can see what I'm working on and the components that relate to the main component that I've clicked on here I've clicked on the esp32 module and you can see the components that are around it I'm going to be starting with the capacitors to position them and then with the resistors so I'm going to place C8 right there right next to the

3.3 volt pin and actually one thing that I want to do is to make the rats nest a little bit more pronounced because I think they're very thin and it's just barely visible so let's go into kick it settings the rat nest's align thickness to let's make it one and see what that looks like a little better I'm just going to make it a little bigger because of so many it really helps having ratest e to see and I'm also going to change that to curved lines I'll make it a bit thicker let's go to Callis and look for rist I think this

color kind of Blends in the dark background so I'm going to make it green striking all right there you go now this can't be missed all right so this is a good good spot for C8 C7 I'm just going to move it here then I'm going to go for our 15 move that out of the way so this is R 20 just move that here for a second R15 I'll oriented like this you can see that goes near pin six and then R2 that can kill it right there or yeah I want to a little bit of symmetry as well so I'm going to make it like this another thing that I've done just

now is to click on this rut Nest button and enable a mode where only the rut nests of the component that I've selected appear and that just reduces clutter significantly and then one last thing that I do as I go is I'm going to move the labels oron so they're not overlapping let's change the filter for this can select text and now that I've got text I can move these values appropriately what I'll do as well just to reduce clutter is I'm going to make all these disappear so here you can see that the value appears the value uh text 50 yeah I'm

going to make those disappear as well but I'm going to do that across all of the components so that the values don't appear at all going to double click to see which layer this comes on so the value appears on and on the ffab layer so what I'll do I will click on F Fab and make the disappear all right that's better now 20 this is in the front silk screen so I'm just going to change the color of the front silk screen so that it's easier to see I'm just going to make it kind of yellowish like this that's it with the esp32

let's continue with the SD card now so click on the SD card module and see what we have I'll start with the capacitors as always so I've got C12 and C13 C12 just going to move R6 out of the way for the time being and so C13 so I've selected local rust Nest by clicking on this button right here so again that allows me to see the r nists for the selected components here's a r nist for C13 place that very close to pinch 4 and three of the SD card that's great and let's go for 12 flip that and I'm going to place like

that right next to C13 and move its label up there the plan here is eventually even though the r nests are directing my attention elsewhere so you can see that there's pain 2 on C12 and pin 6 on the SD card module what I've got to do is to connect those two together and this R Nest line will be satisfied so I've got these two capacitors sorted then let's do the r19 pullup resistor which actually I've done it already so that's done and then let's go for R16 so R16 I'm going to connect that or place it probably here place it

here like this you can see here that the missile line starts right there on the esp32 module and then it goes to this resistor and then it continues to travel elsewhere remember I'm going to be using a bust appology for the SPI now that I have sorted out the peripheral components for u3 and j3 what I can do is to remove this empty space by dragging the SD card and its components slightly up higher and that would release that space down here I didn't want to move the u3 component down because I've already taken a bit of time to do the drawing

here for the cut out of the board so I'm actually going to select this bundle of components and lock it in place and I'm going to do the same for the SD card I'm going to lock this in place because I'm pretty happy with this configuration all right now I can move this line up a little this L can go up to here and that's starting to define the final shape of the board next I'll continue with the flush memory and I'm also going to move the test points out of the way as well I'm going to do those last because the

specific location of the test points is not really important I'm going to put the test points in appropriate locations once everything else has been positioned let's continue with U6 which is the memory so U6 has got a capacitor here which is c14 the orientation of U6 is fine as it is so no problems there just going to move that out of the way just going to place the U6 component a bit closer to the board just to minimize the track length c14 you can see is uh the coupling capacitor for U6 I'll place it near pins 3 and four so you can see the

traces will be minimal here even a little closer would be good so down with c14 then I've got R22 which is missile so R22 will be connected to pin two so rotate and I'll position it here so from here I line will go there and then this positioning it would be minimal distance to travel to pin 16 So the plan here is that from pin 16 I'm going to do the routing so that the signal reaches the SD card module first since this is closer and then it will travel to the flash memory so this position for R2 is good and that's it with these two

components so I will select them and tuck them a little bit closer to the other two two components say around here and I'm leaving enough space up here for tracks to travel from the left side of the board to the esp32 I'm not going to lock this component in place but instead I am going to group it together so now if I want to do something with it if I need to move it for example just by a little to make room for traces I can move the entire group of components together instead of one component at a time I can always ungroup it if I need

four whatever reason let's continue with the environment sensor I think I've just noticed an error found this resistor R30 that both pads are connected to ground and on closer inspection yes that is true you can see R30 goes from ground then up here towards pin three and then there's another wire here taking it down to ground again which is obviously not correct this is something that I didn't notice earlier and the ESC of course didn't notice it it can't make inferences like this maybe later with artificial intelligence plugins to kick

it will be able to point out that this doesn't make sense so this obviously a drawing issue that I didn't notice earlier so let me just fix it really quickly this is a good example of what can happened during a live design session what's happened here is that okay this is correct however this line here is not correct I'm going to delete it and move this ground right there actually move it a little bit further just to make it look a little nicer now I've got the ground of the microphone going to ground I've got the second pin of r29 going to

ground and I've got R30 10K also going to ground but one thing that I don't have is an extra capacitor here a need capacitor in between R30 and ground which I also totally forgot so let's do that there's going to be a one U capacitor going to add a new one so capacitor just a regular capacitor I'm just going to put it here change its name this is going to be c19 and its value will be one microfarads and let's put it in place move that save and now I need to import c19 into the layout editor so save and then import updated

PCB okay no foodprint assigned of course so let's set a footprint let's go to the associations editor and here's a footprint that is missing you can see I went to C8 then to 20 it just missed one capacitor it's going to be the same type capacitor as the rest for the footprint so capacitor SMD just going to search for 0805 metric like the rest all right save go back to the layout editor and update the PCB cool and here's the capacitor was missing well this is uh very unusual but it does happen and it did happen during

my recording which is great because I was able to show you how to fix a forgotten component like this very easy as you can see in Kick at 9 got R30 here and c19 these two work together and because there's a capacitor involved I'm going to give it a bit more space and bring it a bit closer to the active component the amplifier move that up a little all right so now I've got let's check the RS yeah okay I've got this did together so it's that's in series I've got that going to pin three then from pin two hold on a second I just noticed one

more capacitor missing so this supposed to be another capacitor right here and it's another filtering capacitor on the output of the microphone let's fix that I am going to bring up a new capacitor and just put it here for now let's edit its properties so this is going to be C 17 and its value is uh 10 nanofarads and that's supposed to go right here in between these two Junctions and let's bring it across to the layout and pretty sure that this is the last Omission let's go to layout editor and import this new part okay no footprint

assigned of course I forgot that as well so this is also going to be a capacitor SMD or 805 metric all right save and let's bring it into the layout editor done all right so c17 let's place it here for now so I'm just going to do a bit of work now to tidy up the locations for this network [Music]

just [Music] this is slightly different to my original design where I had the connectors for the gpio on the left Edge but I think that is okay the way it is now it does give us a smaller board in most cases smaller is better but in this case I don't think that we are actually losing anything from the board by moving the connectors on the top side from the left to the top just going to consider one more possibility here cuz I'm looking at the microphone and the mic out is on pin four of this integrated circuit so I'm thinking that another

option that I have here is to flip this entire group like this so now the output of this group of components to the esp32 will be out of this pin here you can see it right there so that will make routing a bit easier and it will also allow us to have the microphone which is a relatively large component towards the outside of the board and again you can imagine if this is in a box then you can have the box with an opening on the side here just to allow for sound waves to be captured by the microphone without other

components interfering there's still room for changes so I'm just going to save a little bit more space while a minute and I'm going to further refine the outline a little later with rounded corners but for now this is fine as is save that's what the board looks like at the moment all right so the next thing to do is to start working on the routes so I'm going to start drawing routes and copper zones I've got the placement all done so I'm about to start with the routing but before I do that I want to take a few

minutes to refine the outline because I think now this is going to stay like this I don't think I'm going to need to make any changes in the future refining the outline simply means in this case to replace these sharp Corners with nice rounded corners and kick at n can do that really really quickly as you're about to see another thing I'm going to do is to add a few mounting points I'm going to use up all available space that I have and let's select the edge Cuts layer what I need to do I'm going to show you a really nice trick uh this

process of rounding Corners us to be very tedious in the past but now it isn't so I've selected Graphics right here I've selected Edge Cuts okay so I've got graphics selected I'm in Edge Cuts layer so I'm going to type command a or control a to select all of the edges and you can see down here I've got six selected items these are the straight lines that form the outline of the board and I'm just going to right click on one of them go to shape modification and select shampa lines and from here let's say 2 mm you can go like this I guess uh

that's that's okay or let's try one of the other shapes shape modification let's try the fillet I go for 2 mm again that's pretty nice actually I think maybe reduce the rounding a little so undo try again shap modification make it uh fill it and make that a 1 mm fillet yeah that's much better that's pretty nice actually I'm inspecting for any issues with overlapping edges or lines and components and looks fine one that didn't work is this type M override look and just move it a little bit to the left this is why this corner was not

modified was because it was selected to be locked going to type the L key to unlock it now you can see it's no longer locked so I'm going to select this and this Edge and right click and shape modification fill it make it one mm all right there you go so this would have been done automatically by Kick along with all the rest if this particular line wasn't set to lock but it's fine so that part is done the mounting hole holes I'm going to select mounting holes from my footprints Library I'll make it 2 and A2 mm in size

which is a nice size not too big not too small over right lock move that in a little and create a duplicate and put one here as well and then I'll Place one more mounting hole that's enough let's continue with routing now when I say routing I don't just simply mean creating the copper tracks that convey signals and power but also things such as copper zones and then also making a distinction between critical signals and non-critical signals plan is to start by creating the copper zones for the ground then the copper zones for power uh the
